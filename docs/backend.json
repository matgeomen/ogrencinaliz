
{
  "entities": {
    "StudentExamResult": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "StudentExamResult",
      "type": "object",
      "description": "Represents the result of a student for a specific exam, including topic-level analysis.",
      "properties": {
        "exam_name": { "type": "string", "description": "Name of the exam." },
        "date": { "type": "string", "description": "Date of the exam." },
        "class": { "type": "string", "description": "Class of the student (e.g., 8-A)." },
        "student_no": { "type": "number", "description": "Student number." },
        "student_name": { "type": "string", "description": "Student name." },
        "toplam_dogru": { "type": "number" },
        "toplam_yanlis": { "type": "number" },
        "toplam_net": { "type": "number" },
        "toplam_puan": { "type": "number" },
        "turkce": { "$ref": "#/entities/DersAnalizi" },
        "mat": { "$ref": "#/entities/DersAnalizi" },
        "fen": { "$ref": "#/entities/DersAnalizi" },
        "tarih": { "$ref": "#/entities/DersAnalizi" },
        "din": { "$ref": "#/entities/DersAnalizi" },
        "ing": { "$ref": "#/entities/DersAnalizi" }
      },
      "required": ["exam_name", "date", "class", "student_no", "student_name", "toplam_net", "toplam_puan", "turkce", "mat", "fen", "tarih", "din", "ing"]
    },
    "DersAnalizi": {
        "$schema": "http://json-schema.org/draft-07/schema#",
        "title": "DersAnalizi",
        "type": "object",
        "description": "Represents the detailed analysis of a single subject for a student.",
        "properties": {
            "dogru": { "type": "number" },
            "yanlis": { "type": "number" },
            "net": { "type": "number" },
            "kazanimlar": {
                "type": "array",
                "items": { "$ref": "#/entities/KonuAnalizi" }
            }
        },
        "required": ["dogru", "yanlis", "net", "kazanimlar"]
    },
    "KonuAnalizi": {
        "$schema": "http://json-schema.org/draft-07/schema#",
        "title": "KonuAnalizi",
        "type": "object",
        "description": "Represents the student's performance on a single topic/question.",
        "properties": {
            "konu": { "type": "string" },
            "sonuc": { "type": "string", "enum": ["D", "Y", "B"] }
        },
        "required": ["konu", "sonuc"]
    },
    "UserProfile": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "UserProfile",
      "type": "object",
      "description": "Represents a user's profile information and preferences.",
      "properties": {
        "uid": { "type": "string", "description": "The user's unique ID." },
        "email": { "type": "string", "format": "email", "description": "The user's email address." },
        "displayName": { "type": "string", "description": "The user's display name." },
        "photoURL": { "type": "string", "format": "uri", "description": "URL of the user's profile picture." },
        "role": { "type": "string", "enum": ["admin", "user"], "description": "The user's role." },
        "createdAt": { "type": "string", "format": "date-time", "description": "The timestamp of when the user was created." },
        "storagePreference": { "type": "string", "enum": ["local", "cloud", "both"], "description": "User's data storage preference." },
        "apiKey": { "type": "string", "description": "User's GenAI API Key" }
      },
      "required": ["uid", "email", "role", "createdAt"]
    }
  },
  "auth": {
    "providers": ["email"]
  },
  "firestore": {
    "structure": [
      {
        "path": "/users/{userId}",
        "definition": {
          "entityName": "UserProfile",
          "schema": { "$ref": "#/entities/UserProfile" },
          "description": "Stores user profile information."
        }
      },
      {
        "path": "/users/{userId}/results/{resultId}",
        "definition": {
          "entityName": "StudentExamResult",
          "schema": { "$ref": "#/entities/StudentExamResult" },
          "description": "Stores individual student exam results, including topic analysis, for a specific user."
        }
      }
    ]
  }
}
